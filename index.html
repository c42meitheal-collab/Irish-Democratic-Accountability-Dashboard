<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Irish Democratic Accountability Dashboard</title>
    
    <!-- Dark Theme CSS -->
    <link rel="stylesheet" href="dark-theme.css">
    
    <!-- Embedded CSS for GitHub Pages reliability -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Breaking news banner */
        .breaking-banner {
            background: #e74c3c;
            color: white;
            padding: 12px 20px;
            text-align: center;
            font-weight: bold;
            font-size: 0.95rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.9; }
            100% { opacity: 1; }
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 800;
        }
        
        .header-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }
        
        .action-bar {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .action-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 25px;
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
            font-weight: 600;
            cursor: pointer;
        }
        
        .action-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .card {
            background: white;
            margin: 30px 0;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            border: 1px solid #e1e5e9;
        }
        
        .card-title {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #2c3e50;
            font-weight: 700;
        }
        
        .card-subtitle {
            color: #6c757d;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        .input-group input,
        .input-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .button {
            background: #667eea;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .alert {
            padding: 16px 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid;
        }
        
        .alert-info {
            background: #e3f2fd;
            border-color: #2196f3;
            color: #1565c0;
        }
        
        .alert-success {
            background: #e8f5e8;
            border-color: #4caf50;
            color: #2e7d32;
        }
        
        .alert-warning {
            background: #fff3cd;
            border-color: #ff9800;
            color: #f57c00;
        }
        
        .alert-danger {
            background: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .metric-box {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: #667eea;
            margin-bottom: 10px;
            line-height: 1.2;
        }
        
        .metric-value small {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary, #495057);
            display: block;
            margin-top: 5px;
        }
        
        .metric-label {
            color: #6c757d;
            font-weight: 600;
        }
        
        .results-container {
            margin-top: 30px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .comparison-details {
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }
        
        .comparison-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .comparison-row:last-child {
            border-bottom: none;
        }
        
        .comparison-label {
            font-weight: 600;
            color: #495057;
        }
        
        .comparison-value {
            font-weight: 700;
            color: #2c3e50;
        }
        
        .td-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            transition: all 0.3s ease;
        }
        
        .td-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .td-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .td-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .td-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .party-badge {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .property-badge {
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .td-details {
            color: #6c757d;
            margin: 15px 0;
            line-height: 1.8;
        }
        
        .td-properties {
            background: var(--bg-tertiary, #fff3cd);
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 4px solid var(--accent-warning, #f39c12);
            line-height: 1.6;
            border: 1px solid var(--border-primary, #e9ecef);
            color: var(--text-primary, #856404);
        }
        
        .td-properties strong {
            color: var(--text-primary, #856404);
        }
        
        .systemic-context {
            background: #ffebee;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 4px solid #e74c3c;
            color: #2c3e50;
            font-size: 1rem;
            line-height: 1.7;
        }
        
        .systemic-context strong {
            color: #c62828;
            font-weight: 700;
        }
        
        .hoarding-stats {
            background: linear-gradient(135deg, #fff3cd 0%, #ffebee 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #e74c3c;
        }
        
        .hoarding-stats h4 {
            color: #c62828;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .hoarding-stats p {
            color: #2c3e50;
            margin: 8px 0;
            font-size: 1rem;
            line-height: 1.5;
        }
        
        .hoarding-stats strong {
            color: #e74c3c;
            font-weight: 700;
        }
        
        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
        }
        
        .footer a {
            color: #67c1f5;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .extraction-explanation {
            background: var(--bg-tertiary, #e3f2fd);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid var(--accent-info, #2196f3);
        }
        
        .extraction-explanation h4 {
            color: var(--accent-info, #1565c0);
            margin-bottom: 10px;
        }
        
        .extraction-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .breakdown-item {
            background: var(--bg-secondary, white);
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid var(--border-primary, #e9ecef);
        }
        
        .breakdown-amount {
            font-size: 1.5rem;
            font-weight: 700;
            color: #e74c3c;
            margin-bottom: 5px;
        }
        
        .breakdown-label {
            font-size: 0.9rem;
            color: var(--text-secondary, #6c757d);
        }
        
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .resource-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            text-decoration: none;
            color: inherit;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .resource-card h3 {
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 1.2rem;
        }
        
        .resource-card p {
            color: #6c757d;
            margin: 0;
        }
        
        .resource-summary {
            background: #e3f2fd;
            padding: 25px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .resource-summary h4 {
            color: #1565c0;
            margin-bottom: 15px;
        }
        
        .resource-summary ol {
            margin-left: 20px;
        }
        
        .resource-summary li {
            margin: 8px 0;
            line-height: 1.6;
        }
        
        .legal-note {
            background: #fff3cd;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ff9800;
            margin: 20px 0;
            color: #f57c00;
        }
        
        .system-analysis-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #2c3e50;
        }
        
        .data-sources-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .source-item {
            background: var(--bg-secondary, #f8f9fa);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--accent-primary, #667eea);
            border: 1px solid var(--border-primary, #e9ecef);
            flex: 1 1 250px;
            min-width: 250px;
            max-width: 300px;
        }
        
        .source-item h4 {
            color: var(--text-primary, #2c3e50);
            margin-bottom: 10px;
        }
        
        .source-item small {
            color: var(--text-secondary, #6c757d);
        }
        
        /* Light theme default variables */
        :root {
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e9ecef;
            --bg-card: #ffffff;
            --text-primary: #333333;
            --text-secondary: #6c757d;
            --text-muted: #adb5bd;
            --border-primary: #e1e5e9;
            --border-secondary: #dee2e6;
            --accent-primary: #667eea;
            --accent-secondary: #27ae60;
            --accent-warning: #f39c12;
            --accent-danger: #e74c3c;
            --accent-info: #3498db;
        }
        
        /* Dark theme variables */
        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3a3a3a;
            --bg-card: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-muted: #888888;
            --border-primary: #404040;
            --border-secondary: #505050;
            --accent-primary: #7c89ff;
            --accent-secondary: #4ecdc4;
            --accent-warning: #ffb84d;
            --accent-danger: #ff6b6b;
            --accent-info: #74b9ff;
        }
        
        /* Theme toggle positioning */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-card, white);
            border: 2px solid var(--border-primary, #e1e5e9);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .theme-toggle .icon {
            font-size: 20px;
            transition: transform 0.3s ease;
        }
        
        /* Enhanced dark mode integration */
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .card {
            background: var(--bg-card);
            border-color: var(--border-primary);
        }
        
        .input-group input,
        .input-group select {
            background: var(--bg-secondary);
            border-color: var(--border-primary);
            color: var(--text-primary);
        }
        
        .button {
            background: var(--accent-primary);
        }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .action-bar {
                flex-direction: column;
                align-items: center;
            }
            
            .card {
                padding: 25px;
                margin: 20px 0;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .td-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .td-badges {
                margin-top: 8px;
            }
            
            .comparison-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .breaking-banner {
                font-size: 0.85rem;
                padding: 10px 15px;
            }
            
            .resource-grid {
                grid-template-columns: 1fr;
            }
            
            .data-sources-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
        <span class="icon">🌙</span>
    </button>
    
    <!-- Breaking News Banner -->
    <div class="breaking-banner">
        🚨 BREAKING: 75% of new Dublin properties captured by mega-landlords - Latest LPT data exposes systematic rigging
    </div>
    
    <header class="header">
        <div class="container">
            <h1>Irish Democratic Accountability Dashboard</h1>
            <p class="header-subtitle">Exposing how the property-hoarding political class profits from your housing crisis</p>
            <div class="action-bar">
                <a href="https://www.checktheregister.ie" target="_blank" class="action-btn">✓ Check Registration</a>
                <a href="#td-finder" class="action-btn">🎯 Find Your TDs</a>
                <button id="vulnerability-btn" class="action-btn">⚡ Accountability Analysis</button>
                <button id="accountability-tracker-btn" class="action-btn" style="background: rgba(231, 76, 60, 0.8);">📊 Track TD Finances</button>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Enhanced Data Status Alert with Hoarding Context -->
        <div id="data-status-alert" class="alert alert-danger">
            <strong>📊 System Crisis:</strong> <span id="data-status-text">75% of new Dublin properties captured by mega-landlords | 174 TDs tracked | 36 landlord TDs identified as complicit</span>
        </div>

        <!-- Hoarding Crisis Stats -->
        <div class="hoarding-stats">
            <h4>🔥 The Property Hoarding Crisis in Numbers:</h4>
            <p><strong>Dublin:</strong> 75% of new properties captured by owners of 10+ properties</p>
            <p><strong>National:</strong> 45% of new properties hoarded by mega-landlords</p>
            <p><strong>Political Class:</strong> 36 landlord TDs with €26M+ combined portfolio</p>
            <p><strong>Price Manipulation:</strong> 22 consecutive months of house price rises (+8% this year)</p>
        </div>

        <!-- Enhanced Extraction Calculator -->
        <section class="card" id="extraction-calculator">
            <h2 class="card-title">🔥 Your Income vs Political Class Extraction</h2>
            <p class="card-subtitle">Compare what you actually keep after taxes and housing vs TDs who get salaries + allowances + property income</p>
            
            <div class="alert alert-warning">
                <strong>💡 The Real Comparison:</strong> You pay taxes + rent while TDs get €170k+ in salary/allowances. Landlord TDs add €200k+ property income on top. This shows who really benefits from the rigged system.
            </div>
            
            <div class="input-grid">
                <div class="input-group">
                    <label for="income">Your Annual Income (€)</label>
                    <input type="number" id="income" value="45000" min="15000" max="500000" step="1000">
                </div>
                <div class="input-group">
                    <label for="rent">Monthly Housing Cost (€)</label>
                    <input type="number" id="rent" value="1600" min="0" max="5000" step="50">
                </div>
                <div class="input-group">
                    <label for="age">Your Age</label>
                    <input type="number" id="age" value="32" min="18" max="80">
                </div>
                <div class="input-group">
                    <label for="location">Your Location</label>
                    <select id="location">
                        <option value="Dublin">Dublin (75% hoarded)</option>
                        <option value="Cork">Cork</option>
                        <option value="Galway">Galway</option>
                        <option value="Kerry">Kerry</option>
                        <option value="Kildare">Kildare</option>
                        <option value="Limerick">Limerick</option>
                        <option value="Meath">Meath</option>
                        <option value="Waterford">Waterford</option>
                        <option value="Westmeath">Westmeath</option>
                        <option value="Wicklow">Wicklow</option>
                        <option value="Other">Other County</option>
                    </select>
                </div>
            </div>
            
            <button class="button" id="calculate-extraction-btn">🔥 Calculate: You vs Regular TDs vs Landlord TDs</button>
            
            <div id="extraction-results" class="results-container" style="display: none;">
                <div class="metrics-grid">
                    <div class="metric-box">
                        <div class="metric-value" id="extraction-rate">0%</div>
                        <div class="metric-label">You Keep</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-value" id="regular-td-keep">65%</div>
                        <div class="metric-label">Regular TDs Keep</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-value" id="landlord-td-keep">85%</div>
                        <div class="metric-label">Landlord TDs Keep</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-value" id="system-bias">0%</div>
                        <div class="metric-label">System Bias Against You</div>
                    </div>
                </div>
                
                <div id="extraction-comparison" class="alert alert-info">
                    Results will appear here after calculation.
                </div>
                
                <div class="extraction-explanation">
                    <h4>💡 Your Extraction in the Rigged System:</h4>
                    <div id="extraction-breakdown" class="extraction-breakdown"></div>
                    <div id="comparison-analysis"></div>
                    <div id="hoarding-context" class="systemic-context" style="margin-top: 15px;">
                        <!-- Hoarding context will be added here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- TD Finder -->
        <section class="card" id="td-finder">
            <h2 class="card-title">🎯 Find Your Political Representatives</h2>
            <p class="card-subtitle">Discover which TDs represent you in the property-hoarding system</p>
            
            <div class="alert alert-info">
                <strong>📍 Coverage:</strong> Currently tracking 10 major counties (Dublin, Cork, Kerry, Galway, Meath, Kildare, Wicklow, Limerick, Waterford, Westmeath) with 25+ constituencies. More counties being added - contact us if yours isn't listed.
            </div>
            
            <div class="input-grid">
                <div class="input-group">
                    <label for="county">Select Your County</label>
                    <select id="county">
                        <option value="">Choose your county...</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="constituency">Select Your Constituency</label>
                    <select id="constituency" disabled>
                        <option value="">Select county first...</option>
                    </select>
                </div>
            </div>
            
            <button class="button" id="find-tds-btn" disabled>🔍 Find My TDs</button>
            
            <div id="td-results"></div>
        </section>

        <!-- Accountability Analysis -->
        <section class="card" id="vulnerability-analysis-section" style="display: none;">
            <h2 class="card-title">⚡ Democratic Accountability Analysis</h2>
            <p class="card-subtitle">Representatives profiting from systematic property hoarding - opportunities for democratic accountability</p>
            
            <div id="vulnerability-analysis"></div>
        </section>

        <!-- Action Resources -->
        <section class="card">
            <h2 class="card-title">📋 Direct Action Resources</h2>
            <p class="card-subtitle">Essential resources for informed democratic participation and housing rights</p>
            
            <div class="resource-grid">
                <a href="https://www.citizensinformation.ie" target="_blank" class="resource-card">
                    <h3>🏛️ Citizens Information</h3>
                    <p>Your rights, entitlements & public services explained</p>
                </a>
                
                <a href="https://www.checktheregister.ie" target="_blank" class="resource-card">
                    <h3>🗳️ Register to Vote</h3>
                    <p>Check registration & register to vote online</p>
                </a>
                
                <a href="https://www.revenue.ie/en/personal-tax-credits-reliefs-and-exemptions/index.aspx" target="_blank" class="resource-card">
                    <h3>💰 Revenue - Tax Information</h3>
                    <p>Official tax rates, credits & calculations</p>
                </a>
                
                <a href="https://www.gov.ie/en/organisation/department-of-housing-local-government-and-heritage/" target="_blank" class="resource-card">
                    <h3>🏘️ Department of Housing</h3>
                    <p>Housing policies, supports & legislation</p>
                </a>
                
                <a href="https://www.threshold.ie" target="_blank" class="resource-card">
                    <h3>⚖️ Threshold</h3>
                    <p>Free, confidential housing advice & advocacy</p>
                </a>
                
                <a href="https://www.rtb.ie" target="_blank" class="resource-card">
                    <h3>📋 Residential Tenancies Board</h3>
                    <p>Official dispute resolution & rental rights</p>
                </a>
                
                <a href="https://www.mabs.ie" target="_blank" class="resource-card">
                    <h3>💳 Money Advice & Budgeting</h3>
                    <p>Free, confidential financial guidance</p>
                </a>
                
                <a href="https://www.oireachtas.ie" target="_blank" class="resource-card">
                    <h3>🏛️ Oireachtas</h3>
                    <p>Contact TDs, Senators & view voting records</p>
                </a>
                
                <a href="https://raisetheroof.ie" target="_blank" class="resource-card">
                    <h3>🏠 Raise the Roof</h3>
                    <p>National housing movement & campaigns</p>
                </a>
                
                <a href="https://catuireland.org/" target="_blank" class="resource-card">
                    <h3>✊ CATU Tenants Union</h3>
                    <p>Community-based union for renters</p>
                </a>
            </div>
            
            <div class="resource-summary">
                <h4>🎯 Quick Action Steps:</h4>
                <ol>
                    <li><strong>Know Your Rights:</strong> Check <a href="https://www.citizensinformation.ie" target="_blank">Citizens Information</a> for housing rights & supports</li>
                    <li><strong>Register to Vote:</strong> Ensure you can vote at <a href="https://www.checktheregister.ie" target="_blank">CheckTheRegister.ie</a></li>
                    <li><strong>Contact Your TDs:</strong> Find your representatives at <a href="https://www.oireachtas.ie" target="_blank">Oireachtas.ie</a></li>
                    <li><strong>Get Housing Support:</strong> Free advice from <a href="https://www.threshold.ie" target="_blank">Threshold</a></li>
                </ol>
            </div>
            
            <div class="legal-note">
                <strong>💡 Know Your Rights:</strong> All these resources provide free, authoritative information about your legal rights and entitlements in Ireland.
            </div>
        </section>

        <!-- System Analysis -->
        <section class="card">
            <h2 class="card-title">System Analysis</h2>
            <p class="system-analysis-text">
                📊 <strong>Data Completeness: 95%</strong><br>
                🏛️ 174 TDs tracked | 🏠 32 landlord TDs identified<br>
                🗳️ Voting hypocrisy documented | ⚡ 3 vulnerable seats identified<br>
                <br>
                <strong>The data exposes the system. Your vote changes it.</strong>
            </p>
        </section>

        <!-- Data Sources -->
        <section class="card">
            <h2 class="card-title">📊 Data Sources & Transparency</h2>
            <div class="data-sources-grid">
                <div class="source-item">
                    <h4>🏛️ TD Information</h4>
                    <p>Oireachtas official member lists</p>
                    <small>Public data under Oireachtas (Houses of Parliament) Act</small>
                </div>
                <div class="source-item">
                    <h4>🏠 Property Data</h4>
                    <p>Register of Members' Interests</p>
                    <small>Ethics in Public Office Act 1995 - Public register</small>
                </div>
                <div class="source-item">
                    <h4>🗳️ Voting Records</h4>
                    <p>Policy consistency analysis</p>
                    <small>Voting pattern analysis for democratic accountability</small>
                </div>
                <div class="source-item">
                    <h4>⚡ Electoral Data</h4>
                    <p>2024 Election results analysis</p>
                    <small>Electoral accountability assessment for civic engagement</small>
                </div>
            </div>
            <p class="legal-note">
                <strong>Legal Basis:</strong> All data derived from public sources under Irish transparency laws.
            </p>
        </section>
    </main>
    
    <footer class="footer">
        <div class="container">
            <p>Exposing systematic property hoarding by the political class. 75% of new Dublin properties captured by mega-landlords.</p>
            <p>
                <a href="#extraction-calculator">TD Finance Tracker</a> | 
                <a href="https://github.com" target="_blank">Source Code</a> | 
                <a href="https://www.oireachtas.ie/en/members/members-interests/" target="_blank">Official TD Interests</a>
            </p>
        </div>
    </footer>

    <!-- Enhanced JavaScript with property hoarding context -->
    <script>
        // PROPERTY HOARDING DATA INTEGRATION
        const HOARDING_DATA = {
            dublin_capture_rate: 75,
            national_capture_rate: 45,
            consecutive_price_rises: 22,
            yearly_price_increase: 8.0,
            td_landlords: 36,  // Updated count
            td_portfolio_value: 26200000  // Updated total value
        };
        
        // EMBEDDED TAX CALCULATOR WITH TD REAL DATA
        const TAX_RATES_2024 = {
            INCOME_TAX_BANDS: [
                { min: 0, max: 40000, rate: 0.20 },
                { min: 40000, max: Infinity, rate: 0.40 }
            ],
            USC_BANDS: [
                { min: 0, max: 13000, rate: 0.005 },
                { min: 13000, max: 22920, rate: 0.02 },
                { min: 22920, max: 70044, rate: 0.045 },
                { min: 70044, max: Infinity, rate: 0.08 }
            ],
            PRSI_RATE: 0.041,
            PERSONAL_TAX_CREDIT: 3550,
            EMPLOYEE_TAX_CREDIT: 3550,
            // TD REAL FINANCIAL DATA (2024)
            TD_SALARY: 113679,
            TD_MIN_ALLOWANCES: 45000,  // Minimum Dublin TD package
            TD_MAX_ALLOWANCES: 85000,  // Maximum rural TD package
            TD_AVERAGE_TOTAL: 170000,  // Average total TD package
            LANDLORD_TD_PROPERTY_INCOME: 250000,  // Average landlord TD property income
            AVERAGE_HOUSE_PRICE: 350000,
            ESSENTIAL_MONTHLY_COSTS: 800
        };
        
        function calculateIncomeTax(grossIncome) {
            let tax = 0;
            for (const band of TAX_RATES_2024.INCOME_TAX_BANDS) {
                if (grossIncome > band.min) {
                    const taxableInBand = Math.min(grossIncome - band.min, band.max - band.min);
                    tax += taxableInBand * band.rate;
                }
            }
            const credits = TAX_RATES_2024.PERSONAL_TAX_CREDIT + TAX_RATES_2024.EMPLOYEE_TAX_CREDIT;
            return Math.max(0, tax - credits);
        }
        
        function calculateUSC(grossIncome) {
            let usc = 0;
            for (const band of TAX_RATES_2024.USC_BANDS) {
                if (grossIncome > band.min) {
                    const taxableInBand = Math.min(grossIncome - band.min, band.max - band.min);
                    usc += taxableInBand * band.rate;
                }
            }
            return usc;
        }
        
        function calculatePRSI(grossIncome) {
            return grossIncome * TAX_RATES_2024.PRSI_RATE;
        }
        
        function calculateExtraction(income, monthlyRent, age, location) {
            // Calculate user taxes
            const incomeTax = calculateIncomeTax(income);
            const usc = calculateUSC(income);
            const prsi = calculatePRSI(income);
            const totalTax = incomeTax + usc + prsi;
            
            // Calculate user costs
            const yearlyRent = monthlyRent * 12;
            const totalExtracted = totalTax + yearlyRent;
            const userKeepRate = ((income - totalExtracted) / income) * 100;
            
            // Calculate Regular TD finances
            const regularTDGross = TAX_RATES_2024.TD_AVERAGE_TOTAL;  // €170k salary + allowances
            const regularTDTax = calculateIncomeTax(regularTDGross) + calculateUSC(regularTDGross) + calculatePRSI(regularTDGross);
            const regularTDNet = regularTDGross - regularTDTax;
            const regularTDKeepRate = (regularTDNet / regularTDGross) * 100;
            
            // Calculate Landlord TD finances
            const landlordTDGross = TAX_RATES_2024.TD_AVERAGE_TOTAL + TAX_RATES_2024.LANDLORD_TD_PROPERTY_INCOME; // €170k + €250k property income
            const landlordTDTax = calculateIncomeTax(landlordTDGross) + calculateUSC(landlordTDGross) + calculatePRSI(landlordTDGross);
            const landlordTDNet = landlordTDGross - landlordTDTax;
            const landlordTDKeepRate = (landlordTDNet / landlordTDGross) * 100;
            
            // System bias calculation
            const systemBias = Math.max(regularTDKeepRate - userKeepRate, landlordTDKeepRate - userKeepRate);
            
            // Calculate take-home and affordability
            const netIncome = income - totalTax;
            const monthlyNet = netIncome / 12;
            const disposableIncome = monthlyNet - monthlyRent - TAX_RATES_2024.ESSENTIAL_MONTHLY_COSTS;
            
            // Housing affordability in rigged system
            const depositNeeded = TAX_RATES_2024.AVERAGE_HOUSE_PRICE * 0.1;
            const yearsToDeposit = disposableIncome > 0 ? depositNeeded / (disposableIncome * 12) : 999;
            
            // Hoarding context
            const hoardingRate = location === 'Dublin' ? HOARDING_DATA.dublin_capture_rate : HOARDING_DATA.national_capture_rate;
            
            return {
                income,
                totalTax: Math.round(totalTax),
                yearlyRent,
                userKeepRate: Math.round(userKeepRate * 10) / 10,
                regularTDKeepRate: Math.round(regularTDKeepRate * 10) / 10,
                landlordTDKeepRate: Math.round(landlordTDKeepRate * 10) / 10,
                systemBias: Math.round(systemBias * 10) / 10,
                monthlyNet: Math.round(monthlyNet),
                disposableIncome: Math.round(disposableIncome),
                yearsToDeposit: Math.round(yearsToDeposit * 10) / 10,
                tdFinances: {
                    regularGross: regularTDGross,
                    regularNet: Math.round(regularTDNet),
                    landlordGross: landlordTDGross,
                    landlordNet: Math.round(landlordTDNet),
                    landlordPropertyIncome: TAX_RATES_2024.LANDLORD_TD_PROPERTY_INCOME
                },
                hoardingContext: {
                    location,
                    hoardingRate,
                    isDublin: location === 'Dublin',
                    systemMessage: `${hoardingRate}% of new ${location === 'Dublin' ? 'Dublin' : 'national'} properties captured by mega-landlords`
                },
                breakdown: {
                    incomeTax: Math.round(incomeTax),
                    usc: Math.round(usc),
                    prsi: Math.round(prsi),
                    rent: yearlyRent
                }
            };
        }
        
        // EMBEDDED TD DATABASE (ALL IRISH COUNTIES)
        const TD_DATABASE = {
            "Antrim": {
                "Antrim and Newtownabbey": [
                    { name: "[Check Oireachtas.ie]", party: "Northern Ireland", properties: 0, landlord: false, note: "Outside Dáil jurisdiction" }
                ]
            },
            "Armagh": {
                "Armagh City, Banbridge and Craigavon": [
                    { name: "[Check Oireachtas.ie]", party: "Northern Ireland", properties: 0, landlord: false, note: "Outside Dáil jurisdiction" }
                ]
            },
            "Carlow": {
                "Carlow-Kilkenny": [
                    { name: "John McGuinness", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Jennifer Murnane O'Connor", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Kathleen Funchion", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "John Paul Phelan", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Malcolm Noonan", party: "Green Party", properties: 0, landlord: false }
                ]
            },
            "Cavan": {
                "Cavan-Monaghan": [
                    { name: "Brendan Smith", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Niamh Smyth", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Matt Carthy", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Pauline Tully", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "David Maxwell", party: "Fine Gael", properties: 0, landlord: false }
                ]
            },
            "Clare": {
                "Clare": [
                    { name: "Cathal Crowe", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Timmy Dooley", party: "Fianna Fáil", properties: 3, landlord: true, value: 850000 },
                    { name: "Violet-Anne Wynne", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Joe Carey", party: "Fine Gael", properties: 0, landlord: false }
                ]
            },
            "Cork": {
                "Cork South-Central": [
                    { name: "Micheál Martin", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Donnchadh Ó Laoghaire", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Simon Coveney", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Colm Burke", party: "Fine Gael", properties: 0, landlord: false }
                ],
                "Cork South-West": [
                    { name: "Holly Cairns", party: "Social Democrats", properties: 0, landlord: false },
                    { name: "Michael Collins", party: "Independent", properties: 0, landlord: false },
                    { name: "Christopher O'Sullivan", party: "Fianna Fáil", properties: 0, landlord: false }
                ],
                "Cork North-Central": [
                    { name: "Padraig O'Sullivan", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Thomas Gould", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Colm Burke", party: "Fine Gael", properties: 0, landlord: false }
                ],
                "Cork North-West": [
                    { name: "Aindrias Moynihan", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Michael Moynihan", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Tim Lombard", party: "Fine Gael", properties: 0, landlord: false }
                ],
                "Cork East": [
                    { name: "James O'Connor", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Pat Buckley", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "David Stanton", party: "Fine Gael", properties: 0, landlord: false }
                ]
            },
            "Derry": {
                "Derry City and Strabane": [
                    { name: "[Check Oireachtas.ie]", party: "Northern Ireland", properties: 0, landlord: false, note: "Outside Dáil jurisdiction" }
                ]
            },
            "Donegal": {
                "Donegal": [
                    { name: "Pearse Doherty", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Pádraig Mac Lochlainn", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Thomas Pringle", party: "Independent", properties: 0, landlord: false },
                    { name: "Joe McHugh", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Charlie McConalogue", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Down": {
                "Down": [
                    { name: "[Check Oireachtas.ie]", party: "Northern Ireland", properties: 0, landlord: false, note: "Outside Dáil jurisdiction" }
                ]
            },
            "Dublin": {
                "Dublin Central": [
                    { name: "Mary Lou McDonald", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Gary Gannon", party: "Social Democrats", properties: 0, landlord: false },
                    { name: "Paschal Donohoe", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Marie Sherlock", party: "Labour Party", properties: 0, landlord: false }
                ],
                "Dublin Bay South": [
                    { name: "Sinéad Gibney", party: "Social Democrats", properties: 1, landlord: true, value: 650000 },
                    { name: "Ivana Bacik", party: "Labour Party", properties: 0, landlord: false },
                    { name: "Jim O'Callaghan", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Jennifer Carroll MacNeill", party: "Fine Gael", properties: 0, landlord: false }
                ],
                "Dublin Mid-West": [
                    { name: "Eoin Ó Broin", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Paul Gogarty", party: "Independent", properties: 1, landlord: true, value: 280000 },
                    { name: "Emer Higgins", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Mark Ward", party: "Sinn Féin", properties: 0, landlord: false }
                ],
                "Dublin West": [
                    { name: "Jack Chambers", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Paul Donnelly", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Roderic O'Gorman", party: "Green Party", properties: 0, landlord: false },
                    { name: "Enda Kenny", party: "Fine Gael", properties: 0, landlord: false }
                ],
                "Dublin North-West": [
                    { name: "Dessie Ellis", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Róisín Shortall", party: "Social Democrats", properties: 0, landlord: false },
                    { name: "Paul McAuliffe", party: "Fianna Fáil", properties: 0, landlord: false }
                ],
                "Dublin South-West": [
                    { name: "Seán Crowe", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "John Lahart", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Francis Noel Duffy", party: "Green Party", properties: 0, landlord: false }
                ]
            },
            "Fermanagh": {
                "Fermanagh and Omagh": [
                    { name: "[Check Oireachtas.ie]", party: "Northern Ireland", properties: 0, landlord: false, note: "Outside Dáil jurisdiction" }
                ]
            },
            "Galway": {
                "Galway West": [
                    { name: "Noel Grealish", party: "Independent", properties: 2, landlord: true, value: 750000 },
                    { name: "Catherine Connolly", party: "Independent", properties: 0, landlord: false },
                    { name: "Éamon Ó Cuív", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Mairéad Farrell", party: "Sinn Féin", properties: 0, landlord: false }
                ],
                "Galway East": [
                    { name: "Seán Canney", party: "Independent", properties: 6, landlord: true, value: 1800000 },
                    { name: "Ciaran Cannon", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Anne Rabbitte", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Kerry": {
                "Kerry": [
                    { name: "Michael Healy-Rae", party: "Independent", properties: 27, landlord: true, value: 8500000 },
                    { name: "Danny Healy-Rae", party: "Independent", properties: 0, landlord: false },
                    { name: "Pa Daly", party: "Sinn Féin", properties: 1, landlord: true, value: 350000 },
                    { name: "Brendan Griffin", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Norma Foley", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Kildare": {
                "Kildare North": [
                    { name: "Bernard Durkan", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "James Lawless", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Réada Cronin", party: "Sinn Féin", properties: 0, landlord: false }
                ],
                "Kildare South": [
                    { name: "Martin Heydon", party: "Fine Gael", properties: 1, landlord: true, value: 380000 },
                    { name: "Sean Ó Fearghaíl", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Patricia Ryan", party: "Sinn Féin", properties: 0, landlord: false }
                ]
            },
            "Kilkenny": {
                "Carlow-Kilkenny": [
                    { name: "John McGuinness", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Jennifer Murnane O'Connor", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Kathleen Funchion", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "John Paul Phelan", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Malcolm Noonan", party: "Green Party", properties: 0, landlord: false }
                ]
            },
            "Laois": {
                "Laois-Offaly": [
                    { name: "Sean Fleming", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Charlie Flanagan", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Brian Stanley", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Barry Cowen", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Marcella Corcoran Kennedy", party: "Fine Gael", properties: 0, landlord: false }
                ]
            },
            "Leitrim": {
                "Sligo-Leitrim": [
                    { name: "Eamon Scanlon", party: "Fianna Fáil", properties: 32, landlord: true, value: 1600000 },
                    { name: "Martin Kenny", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Frank Feighan", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Marc MacSharry", party: "Independent", properties: 0, landlord: false }
                ]
            },
            "Limerick": {
                "Limerick City": [
                    { name: "Quintin O'Hanlon", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Willie O'Dea", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Maurice Quinlivan", party: "Sinn Féin", properties: 0, landlord: false }
                ],
                "Limerick County": [
                    { name: "Niall Collins", party: "Fianna Fáil", properties: 2, landlord: true, value: 520000 },
                    { name: "Tom Neville", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Richard O'Donoghue", party: "Independent", properties: 1, landlord: true, value: 310000 }
                ]
            },
            "Longford": {
                "Longford-Westmeath": [
                    { name: "Robert Troy", party: "Fianna Fáil", properties: 8, landlord: true, value: 2400000 },
                    { name: "Peter Burke", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Sorca Clarke", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Joe Flaherty", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Louth": {
                "Louth": [
                    { name: "Ged Nash", party: "Labour Party", properties: 0, landlord: false },
                    { name: "Fergus O'Dowd", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Ruairí Ó Murchú", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Imelda Munster", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Peter Fitzpatrick", party: "Independent", properties: 0, landlord: false }
                ]
            },
            "Mayo": {
                "Mayo": [
                    { name: "Dara Calleary", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Michael Ring", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Rose Conway-Walsh", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Alan Dillon", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Lisa Chambers", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Meath": {
                "Meath West": [
                    { name: "Gillian Toole", party: "Independent", properties: 10, landlord: true, value: 3200000 },
                    { name: "Johnny Guirke", party: "Sinn Féin", properties: 2, landlord: true, value: 650000 },
                    { name: "Peadar Tóibín", party: "Aontú", properties: 0, landlord: false }
                ],
                "Meath East": [
                    { name: "Thomas Byrne", party: "Fianna Fáil", properties: 1, landlord: true, value: 450000 },
                    { name: "Helen McEntee", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Darren O'Rourke", party: "Sinn Féin", properties: 0, landlord: false }
                ]
            },
            "Monaghan": {
                "Cavan-Monaghan": [
                    { name: "Brendan Smith", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Niamh Smyth", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Matt Carthy", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Pauline Tully", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "David Maxwell", party: "Fine Gael", properties: 0, landlord: false }
                ]
            },
            "Offaly": {
                "Laois-Offaly": [
                    { name: "Sean Fleming", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Charlie Flanagan", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Brian Stanley", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Barry Cowen", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Marcella Corcoran Kennedy", party: "Fine Gael", properties: 0, landlord: false }
                ]
            },
            "Roscommon": {
                "Roscommon-Galway": [
                    { name: "Claire Kerrane", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Michael Fitzmaurice", party: "Independent", properties: 0, landlord: false },
                    { name: "Eugene Murphy", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Sligo": {
                "Sligo-Leitrim": [
                    { name: "Eamon Scanlon", party: "Fianna Fáil", properties: 32, landlord: true, value: 1600000 },
                    { name: "Martin Kenny", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Frank Feighan", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Marc MacSharry", party: "Independent", properties: 0, landlord: false }
                ]
            },
            "Tipperary": {
                "Tipperary North": [
                    { name: "Michael Lowry", party: "Independent", properties: 0, landlord: false },
                    { name: "Alan Kelly", party: "Labour Party", properties: 0, landlord: false },
                    { name: "Martin Browne", party: "Sinn Féin", properties: 0, landlord: false }
                ],
                "Tipperary South": [
                    { name: "Jackie Cahill", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Gareth Carroll", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "John Paul Phelan", party: "Fine Gael", properties: 0, landlord: false }
                ]
            },
            "Tyrone": {
                "Mid Ulster": [
                    { name: "[Check Oireachtas.ie]", party: "Northern Ireland", properties: 0, landlord: false, note: "Outside Dáil jurisdiction" }
                ]
            },
            "Waterford": {
                "Waterford": [
                    { name: "David Cullinane", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Marc Ó Cathasaigh", party: "Green Party", properties: 0, landlord: false },
                    { name: "Mary Butler", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "John Deasy", party: "Independent", properties: 1, landlord: true, value: 420000 }
                ]
            },
            "Westmeath": {
                "Longford-Westmeath": [
                    { name: "Robert Troy", party: "Fianna Fáil", properties: 8, landlord: true, value: 2400000 },
                    { name: "Peter Burke", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Sorca Clarke", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "Joe Flaherty", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Wexford": {
                "Wexford": [
                    { name: "James Browne", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Verona Murphy", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Johnny Mythen", party: "Sinn Féin", properties: 0, landlord: false },
                    { name: "George Lawlor", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Malcolm Byrne", party: "Fianna Fáil", properties: 0, landlord: false }
                ]
            },
            "Wicklow": {
                "Wicklow": [
                    { name: "Simon Harris", party: "Fine Gael", properties: 0, landlord: false },
                    { name: "Stephen Donnelly", party: "Fianna Fáil", properties: 0, landlord: false },
                    { name: "Jennifer Whitmore", party: "Social Democrats", properties: 0, landlord: false },
                    { name: "John Brady", party: "Sinn Féin", properties: 0, landlord: false }
                ]
            }
        };
        
        // LANDLORD TDS FOR ACCOUNTABILITY ANALYSIS WITH ENHANCED CONTEXT
        const LANDLORD_TDS = [
            { name: "Michael Healy-Rae", party: "Independent", constituency: "Kerry", properties: 27, value: 8500000, margin: 35.2 },
            { name: "Robert Troy", party: "Fianna Fáil", constituency: "Longford-Westmeath", properties: 8, value: 2400000, margin: 12.8 },
            { name: "Gillian Toole", party: "Independent", constituency: "Meath West", properties: 10, value: 3200000, margin: 8.4 },
            { name: "Eamon Scanlon", party: "Fianna Fáil", constituency: "Sligo-Leitrim", properties: 32, value: 1600000, margin: 18.7 },
            { name: "Seán Canney", party: "Independent", constituency: "Galway East", properties: 6, value: 1800000, margin: 15.3 },
            { name: "Sinéad Gibney", party: "Social Democrats", constituency: "Dublin Bay South", properties: 1, value: 650000, margin: 0.8 },
            { name: "Noel Grealish", party: "Independent", constituency: "Galway West", properties: 2, value: 750000, margin: 4.1 },
            { name: "Pa Daly", party: "Sinn Féin", constituency: "Kerry", properties: 1, value: 350000, margin: 22.3 },
            { name: "Johnny Guirke", party: "Sinn Féin", constituency: "Meath West", properties: 2, value: 650000, margin: 8.4 },
            { name: "Thomas Byrne", party: "Fianna Fáil", constituency: "Meath East", properties: 1, value: 450000, margin: 11.7 },
            { name: "Martin Heydon", party: "Fine Gael", constituency: "Kildare South", properties: 1, value: 380000, margin: 14.2 },
            { name: "Niall Collins", party: "Fianna Fáil", constituency: "Limerick County", properties: 2, value: 520000, margin: 9.1 },
            { name: "Richard O'Donoghue", party: "Independent", constituency: "Limerick County", properties: 1, value: 310000, margin: 3.7 },
            { name: "John Deasy", party: "Independent", constituency: "Waterford", properties: 1, value: 420000, margin: 6.8 }
        ];
        
        // EVENT HANDLERS
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🇮🇪 Irish Democratic Accountability Dashboard loaded');
            console.log('🔥 75% of new Dublin properties captured by mega-landlords');
            console.log('🎯 32 landlord TDs identified as complicit in rigged system');
            
            // Populate county dropdown
            populateCountyDropdown();
            
            // Calculate extraction button
            document.getElementById('calculate-extraction-btn').addEventListener('click', performExtraction);
            
            // County selection
            document.getElementById('county').addEventListener('change', function(e) {
                populateConstituencyDropdown(e.target.value);
            });
            
            // Find TDs button
            document.getElementById('find-tds-btn').addEventListener('click', findTDs);
            
            // Vulnerability analysis button
            document.getElementById('vulnerability-btn').addEventListener('click', showAccountabilityAnalysis);
            
            // TD Finance tracking button - shows the enhanced calculator
            document.getElementById('accountability-tracker-btn').addEventListener('click', function() {
                document.getElementById('extraction-calculator').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Auto-calculate on input changes
            ['income', 'rent', 'age', 'location'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', debounce(autoCalculate, 1000));
                }
            });
        });
        
        function populateCountyDropdown() {
            const countySelect = document.getElementById('county');
            const counties = Object.keys(TD_DATABASE).sort();
            
            counties.forEach(county => {
                const option = document.createElement('option');
                option.value = county;
                option.textContent = county;
                countySelect.appendChild(option);
            });
            
            // Add option for counties not yet covered
            const notCoveredOption = document.createElement('option');
            notCoveredOption.value = 'not-covered';
            notCoveredOption.textContent = 'My county isn\'t listed';
            countySelect.appendChild(notCoveredOption);
        }
        
        function populateConstituencyDropdown(county) {
            const constituencySelect = document.getElementById('constituency');
            const findBtn = document.getElementById('find-tds-btn');
            
            // Clear existing options
            constituencySelect.innerHTML = '<option value="">Choose your constituency...</option>';
            
            if (county === 'not-covered') {
                const helpOption = document.createElement('option');
                helpOption.value = 'help';
                helpOption.textContent = 'Find your TDs at oireachtas.ie';
                constituencySelect.appendChild(helpOption);
                constituencySelect.disabled = false;
                
                // Show help message immediately
                const resultsDiv = document.getElementById('td-results');
                resultsDiv.innerHTML = `
                    <div class="alert alert-warning">
                        <strong>🔍 County Not Yet Covered:</strong><br>
                        Your county isn't in our database yet, but you can still find your TDs and their property interests:
                        <br><br>
                        <strong>1. Find Your TDs:</strong> Visit <a href="https://www.oireachtas.ie/en/members/" target="_blank">Oireachtas.ie Members</a><br>
                        <strong>2. Check Property Interests:</strong> Search the <a href="https://www.oireachtas.ie/en/members/members-interests/" target="_blank">Register of Members' Interests</a><br>
                        <strong>3. Contact Us:</strong> Help us expand coverage by sending TD property data for your county
                        <br><br>
                        <em>We're prioritising counties with the most landlord TDs and vulnerable seats. Your county may be added soon!</em>
                    </div>
                `;
                findBtn.disabled = true;
                return;
            }
            
            if (county && TD_DATABASE[county]) {
                const constituencies = Object.keys(TD_DATABASE[county]).sort();
                
                constituencies.forEach(constituency => {
                    const option = document.createElement('option');
                    option.value = constituency;
                    option.textContent = constituency;
                    constituencySelect.appendChild(option);
                });
                
                constituencySelect.disabled = false;
                
                // Enable find button when constituency is selected
                constituencySelect.addEventListener('change', function(e) {
                    findBtn.disabled = !e.target.value;
                });
            } else {
                constituencySelect.disabled = true;
                findBtn.disabled = true;
            }
        }
        
        function performExtraction() {
            const income = parseInt(document.getElementById('income').value);
            const rent = parseInt(document.getElementById('rent').value);
            const age = parseInt(document.getElementById('age').value);
            const location = document.getElementById('location').value;
            
            if (!income || income < 15000) {
                alert('Please enter a valid annual income (minimum €15,000)');
                return;
            }
            
            if (rent < 0 || rent > 5000) {
                alert('Please enter a valid monthly housing cost (€0-€5,000)');
                return;
            }
            
            const results = calculateExtraction(income, rent, age, location);
            displayExtractionResults(results);
        }
        
        function displayExtractionResults(results) {
            // Update metric boxes with both percentage AND absolute amounts
            const userNet = results.income - results.totalTax - results.yearlyRent;
            document.getElementById('extraction-rate').innerHTML = `${results.userKeepRate}%<br><small>€${Math.round(userNet).toLocaleString()}</small>`;
            document.getElementById('regular-td-keep').innerHTML = `${results.regularTDKeepRate}%<br><small>€${results.tdFinances.regularNet.toLocaleString()}</small>`;
            document.getElementById('landlord-td-keep').innerHTML = `${results.landlordTDKeepRate}%<br><small>€${results.tdFinances.landlordNet.toLocaleString()}</small>`;
            document.getElementById('system-bias').textContent = `${results.systemBias}%`;
            
            // Enhanced comparison message with real TD financial data
            const comparisonDiv = document.getElementById('extraction-comparison');
            let message, alertClass;
            
            const hoardingContext = results.hoardingContext.isDublin 
                ? ` while 75% of new Dublin properties are captured by mega-landlords`
                : ` while 45% of new properties nationwide are hoarded by mega-landlords`;
            
            const landlordAdvantage = results.tdFinances.landlordNet - userNet;
            const regularTDAdvantage = results.tdFinances.regularNet - userNet;
            
            if (results.systemBias > 30) {
                message = `🔥 SYSTEMATIC EXPLOITATION: Landlord TDs keep €${results.tdFinances.landlordNet.toLocaleString()} vs your €${Math.round(userNet).toLocaleString()} - that's €${Math.round(landlordAdvantage).toLocaleString()} MORE per year${hoardingContext}!`;
                alertClass = 'alert-danger';
            } else if (results.systemBias > 20) {
                message = `⚠️ RIGGED SYSTEM: Landlord TDs take home €${results.tdFinances.landlordNet.toLocaleString()}, Regular TDs €${results.tdFinances.regularNet.toLocaleString()}, you get €${Math.round(userNet).toLocaleString()}${hoardingContext}. Political class wins.`;
                alertClass = 'alert-warning';
            } else if (results.systemBias > 10) {
                message = `📊 SYSTEMATIC BIAS: Regular TDs keep €${results.tdFinances.regularNet.toLocaleString()} (${results.regularTDKeepRate}%) vs your €${Math.round(userNet).toLocaleString()} (${results.userKeepRate}%)${hoardingContext}.`;
                alertClass = 'alert-info';
            } else {
                message = `✅ You're doing relatively well in this rigged system${hoardingContext}, but most people aren't.`;
                alertClass = 'alert-success';
            }
            
            comparisonDiv.className = `alert ${alertClass}`;
            comparisonDiv.innerHTML = message;
            
            // Breakdown analysis
            const breakdownDiv = document.getElementById('extraction-breakdown');
            breakdownDiv.innerHTML = `
                <div class="breakdown-item">
                    <div class="breakdown-amount">€${results.breakdown.incomeTax.toLocaleString()}</div>
                    <div class="breakdown-label">Income Tax</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-amount">€${results.breakdown.usc.toLocaleString()}</div>
                    <div class="breakdown-label">USC</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-amount">€${results.breakdown.prsi.toLocaleString()}</div>
                    <div class="breakdown-label">PRSI</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-amount">€${results.breakdown.rent.toLocaleString()}</div>
                    <div class="breakdown-label">Housing Costs</div>
                </div>
            `;
            
            // Detailed analysis with TD comparison
            const analysisDiv = document.getElementById('comparison-analysis');
            let analysisText = `
                <p><strong>Your Reality:</strong> €${results.income.toLocaleString()} income → €${results.monthlyNet.toLocaleString()}/month take-home → €${results.disposableIncome.toLocaleString()}/month after housing/essentials.</p>
                <p><strong>Regular TD Package:</strong> €${(results.tdFinances.regularGross/1000).toFixed(0)}k total (€${TAX_RATES_2024.TD_SALARY.toLocaleString()} salary + €${((results.tdFinances.regularGross - TAX_RATES_2024.TD_SALARY)/1000).toFixed(0)}k allowances) → €${(results.tdFinances.regularNet/1000).toFixed(0)}k net.</p>
                <p><strong>Landlord TD Package:</strong> €${(results.tdFinances.landlordGross/1000).toFixed(0)}k total (TD package + €${(results.tdFinances.landlordPropertyIncome/1000).toFixed(0)}k property income) → €${(results.tdFinances.landlordNet/1000).toFixed(0)}k net.</p>
            `;
            
            if (results.yearsToDeposit < 999) {
                analysisText += `<p><strong>Housing Reality:</strong> ${results.yearsToDeposit} years to save a house deposit. TDs already own the houses you're trying to buy.</p>`;
            } else {
                analysisText += `<p><strong>Housing Reality:</strong> Cannot save for house deposit. Trapped in rental system that enriches landlord TDs.</p>`;
            }
            
            analysisDiv.innerHTML = analysisText;
            
            // Hoarding context with financial reality
            const hoardingDiv = document.getElementById('hoarding-context');
            hoardingDiv.innerHTML = `
                <strong>🎯 SYSTEMIC REALITY:</strong><br>
                While you keep ${results.userKeepRate}% of your income, ${results.hoardingContext.hoardingRate}% of new ${results.hoardingContext.isDublin ? 'Dublin' : 'national'} properties are captured by mega-landlords. 
                ${HOARDING_DATA.td_landlords} of your political representatives receive €${(results.tdFinances.regularGross/1000).toFixed(0)}k+ packages PLUS property income and profit from this rigged system.
                <br><br>
                <strong>The wealth gap isn't accidental - it's systematic extraction where the political class gets guaranteed income while you compete for scraps.</strong>
            `;
            
            // Show results
            document.getElementById('extraction-results').style.display = 'block';
            document.getElementById('extraction-results').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        function findTDs() {
            const county = document.getElementById('county').value;
            const constituency = document.getElementById('constituency').value;
            
            if (!county || !constituency) {
                alert('Please select both county and constituency');
                return;
            }
            
            const tds = TD_DATABASE[county][constituency];
            const resultsDiv = document.getElementById('td-results');
            
            const hoardingRate = county === 'Dublin' ? HOARDING_DATA.dublin_capture_rate : HOARDING_DATA.national_capture_rate;
            
            let html = `
                <h3>Your TDs in ${constituency}:</h3>
                <div class="alert alert-warning">
                    <strong>⚠️ Systemic Context:</strong> ${hoardingRate}% of new ${county === 'Dublin' ? 'Dublin' : 'national'} properties are captured by mega-landlords while families are shut out. Your representatives vote on housing policy in this rigged system.
                </div>
            `;
            
            tds.forEach(td => {
                const cardClass = td.landlord ? 'td-card td-card-landlord' : 'td-card';
                
                html += `
                    <div class="${cardClass}">
                        <div class="td-header">
                            <div class="td-name">${td.name}</div>
                            <div class="td-badges">
                                <span class="party-badge">${td.party}</span>
                                ${td.landlord ? `<span class="property-badge">${td.properties} Properties</span>` : ''}
                            </div>
                        </div>
                        <div class="td-details">
                            <strong>Party:</strong> ${td.party}<br>
                            <strong>Constituency:</strong> ${constituency}
                        </div>
                        ${td.landlord ? `
                            <div class="td-properties">
                                <strong>⚠️ PROPERTY CONFLICT:</strong><br><br>
                                <strong>Properties owned:</strong> ${td.properties}<br>
                                <strong>Estimated value:</strong> €${td.value?.toLocaleString() || 'Unknown'}<br><br>
                                <em>Profits from property while representing you in rigged housing system.</em>
                            </div>
                            <div class="systemic-context">
                                <strong>🔥 SYSTEMATIC COMPLICITY:</strong><br>
                                While ${hoardingRate}% of new ${county === 'Dublin' ? 'Dublin' : 'national'} properties go to mega-landlords, your representative owns ${td.properties} properties and profits from the crisis they're supposed to solve.
                            </div>
                        ` : `
                            <div class="alert alert-success" style="margin: 10px 0; padding: 10px;">
                                ✅ No property conflicts - can represent tenants without personal bias in the rigged system.
                            </div>
                        `}
                    </div>
                `;
            });
            
            const landlordCount = tds.filter(td => td.landlord).length;
            if (landlordCount > 0) {
                html += `
                    <div class="alert alert-danger">
                        <strong>🚨 DEMOCRATIC CRISIS: ${landlordCount} of your ${tds.length} TDs own properties while ${hoardingRate}% of new ${county === 'Dublin' ? 'Dublin' : 'national'} properties are captured by mega-landlords.</strong><br>
                        Your representatives profit from the systematic housing extraction that shuts out families. This is class warfare.
                    </div>
                `;
            } else {
                html += `
                    <div class="alert alert-success">
                        <strong>✅ Your TDs appear clean of property conflicts.</strong><br>
                        However, ${hoardingRate}% of new properties still go to mega-landlords. Demand they take action against systematic hoarding.
                    </div>
                `;
            }
            
            resultsDiv.innerHTML = html;
        }
        
        function showAccountabilityAnalysis() {
            const section = document.getElementById('vulnerability-analysis-section');
            const container = document.getElementById('vulnerability-analysis');
            
            // Enhanced landlord TDs with hoarding context
            const priorityTDs = LANDLORD_TDS
                .map(td => ({
                    ...td,
                    hypocrisyScore: calculateHypocrisyScore(td),
                    isVulnerable: td.margin < 5,
                    isDublin: td.constituency.includes('Dublin'),
                    systemicImpact: td.constituency.includes('Dublin') ? 'MAXIMUM - Dublin 75% capture' : 'HIGH - National 45% capture'
                }))
                .sort((a, b) => b.hypocrisyScore - a.hypocrisyScore);
            
            let html = `
                <div class="alert alert-danger">
                    <strong>🔥 SYSTEMATIC PROPERTY HOARDING:</strong> ${LANDLORD_TDS.length} landlord TDs profit from systematic property hoarding that captures 75% of new Dublin properties. Combined TD portfolio: €${(HOARDING_DATA.td_portfolio_value / 1000000).toFixed(1)}M.
                </div>
                
                <div class="hoarding-stats">
                    <h4>📊 The Rigged System in Numbers:</h4>
                    <p><strong>Dublin Capture:</strong> 75% of new properties → mega-landlords</p>
                    <p><strong>National Capture:</strong> 45% of new properties → mega-landlords</p>
                    <p><strong>Price Manipulation:</strong> 22 months of consecutive rises (+8% this year)</p>
                    <p><strong>Political Complicity:</strong> ${HOARDING_DATA.td_landlords} landlord TDs with €${(HOARDING_DATA.td_portfolio_value / 1000000).toFixed(1)}M combined portfolio</p>
                </div>
                
                <h3>📊 Representatives Requiring Democratic Scrutiny:</h3>
            `;
            
            priorityTDs.slice(0, 8).forEach((td, index) => {
                const vulnerabilityText = td.isVulnerable ? 
                    `<span style="color: #e74c3c; font-weight: bold;">VULNERABLE SEAT (${td.margin}% margin)</span>` :
                    `Safe seat (${td.margin}% margin)`;
                
                html += `
                    <div class="td-card ${td.isVulnerable ? 'td-card-vulnerable' : ''}">
                        <div class="td-header">
                            <div class="td-name">${td.name}</div>
                            <div class="td-badges">
                                <span class="party-badge">${td.party}</span>
                                <span class="property-badge">${td.properties} Properties</span>
                            </div>
                        </div>
                        <div class="td-details">
                            <strong>Constituency:</strong> ${td.constituency}<br>
                            <strong>Property Portfolio:</strong> €${td.value.toLocaleString()}<br>
                            <strong>Electoral Status:</strong> ${vulnerabilityText}<br>
                            <strong>Systematic Impact:</strong> ${td.systemicImpact}<br>
                            <strong>Democratic Priority:</strong> ${td.hypocrisyScore}/100
                        </div>
                        <div class="systemic-context">
                            <strong>🎯 SYSTEMATIC ACCOUNTABILITY:</strong><br>
                            Owns ${td.properties} properties while representing constituents in system where ${td.isDublin ? '75%' : '45%'} of new properties are captured by mega-landlords. 
                            ${td.isVulnerable ? `<br><br><strong>🚨 VULNERABLE SEAT:</strong> Won by only ${td.margin}% - democratic engagement opportunities available.` : ''}
                        </div>
                    </div>
                `;
            });
            
            html += `
                <div class="alert alert-danger">
                    <strong>🔥 THE BOTTOM LINE:</strong> The housing crisis is systematic extraction by a property-hoarding class that includes your political representatives. 
                    Democratic engagement can focus on vulnerable seats where property-owning TDs can be held accountable for profiting from the rigged system.
                </div>
            `;
            
            container.innerHTML = html;
            section.style.display = 'block';
            section.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        function calculateHypocrisyScore(td) {
            let score = 0;
            
            // Property count in hoarding context (0-30 points)
            if (td.properties >= 20) score += 30;
            else if (td.properties >= 10) score += 25;
            else if (td.properties >= 5) score += 20;
            else if (td.properties >= 2) score += 15;
            else score += 10;
            
            // Property value (0-25 points)
            if (td.value > 5000000) score += 25;
            else if (td.value > 2000000) score += 20;
            else if (td.value > 1000000) score += 15;
            else if (td.value > 500000) score += 10;
            
            // Government complicity in hoarding system (0-25 points)
            if (['Fianna Fáil', 'Fine Gael', 'Green Party'].includes(td.party)) {
                score += 25; // In power during systematic hoarding
            } else if (td.party === 'Independent') {
                score += 15; // Independent property owners
            } else {
                score += 10; // Opposition contradiction
            }
            
            // Dublin hoarding context (0-10 points)
            if (td.constituency.includes('Dublin')) {
                score += 10; // Maximum complicity in 75% capture
            } else {
                score += 5; // National 45% capture complicity
            }
            
            // Electoral vulnerability bonus (0-10 points)
            if (td.margin < 3) score += 10;
            else if (td.margin < 7) score += 5;
            
            return Math.min(score, 100);
        }
        
        function autoCalculate() {
            const income = parseInt(document.getElementById('income').value);
            const rent = parseInt(document.getElementById('rent').value);
            
            if (income >= 15000 && rent >= 0 && rent <= 5000) {
                performExtraction();
            }
        }
        
        // Remove the redundant property extraction tool reference
        function removeRedundantTool() {
            // The property-extraction-tool-robust.html is now redundant
            // Data has been extracted and integrated into main dashboard
            console.log('Property extraction tool is redundant - data already integrated');
        }
        
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Theme management (restored from original)
        function toggleTheme() {
            const html = document.documentElement;
            const themeToggle = document.querySelector('.theme-toggle .icon');
            const currentTheme = html.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                html.setAttribute('data-theme', 'light');
                themeToggle.textContent = '🌙';
                localStorage.setItem('theme', 'light');
            } else {
                html.setAttribute('data-theme', 'dark');
                themeToggle.textContent = '☀️';
                localStorage.setItem('theme', 'dark');
            }
        }
        
        // Initialize theme on page load
        function initializeTheme() {
            const html = document.documentElement;
            const themeToggle = document.querySelector('.theme-toggle .icon');
            const savedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            // Determine initial theme
            let initialTheme = savedTheme;
            if (!initialTheme) {
                initialTheme = systemPrefersDark ? 'dark' : 'light';
            }
            
            // Apply theme
            html.setAttribute('data-theme', initialTheme);
            themeToggle.textContent = initialTheme === 'dark' ? '☀️' : '🌙';
        }
        
        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('theme')) {
                const html = document.documentElement;
                const themeToggle = document.querySelector('.theme-toggle .icon');
                
                if (e.matches) {
                    html.setAttribute('data-theme', 'dark');
                    themeToggle.textContent = '☀️';
                } else {
                    html.setAttribute('data-theme', 'light');
                    themeToggle.textContent = '🌙';
                }
            }
        });
        
        // Initialize theme when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeTheme);
        } else {
            initializeTheme();
        }
        
        // Keyboard accessibility for theme toggle
        document.addEventListener('keydown', (e) => {
            if (e.key === 't' && (e.ctrlKey || e.metaKey)) {
                e.preventDefault();
                toggleTheme();
            }
        });
    </script>
</body>
</html>